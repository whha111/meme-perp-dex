# MemePerp DEX Backend Environment Variables Template
# Copy this file to .env.local for local development
# or .env.production for production deployment

# ============================================
# Application Environment
# ============================================
APP_ENV=local  # Options: local, staging, production

# ============================================
# Database Configuration (REQUIRED)
# ============================================
MEMEPERP_DATABASE_HOST=localhost
MEMEPERP_DATABASE_PORT=5432
MEMEPERP_DATABASE_USER=postgres
MEMEPERP_DATABASE_PASSWORD=  # REQUIRED: Set a secure password
MEMEPERP_DATABASE_NAME=memeperp
MEMEPERP_DATABASE_SSLMODE=disable  # Use 'require' in production

# ============================================
# Redis Configuration
# ============================================
MEMEPERP_REDIS_ADDR=localhost:6379
MEMEPERP_REDIS_PASSWORD=  # Optional for local, REQUIRED for production
MEMEPERP_REDIS_DB=0

# ============================================
# JWT Configuration (REQUIRED)
# ============================================
# Generate with: openssl rand -hex 32
MEMEPERP_JWT_SECRET=  # REQUIRED: Min 32 characters
MEMEPERP_JWT_EXPIRATION=24h

# ============================================
# Blockchain Configuration (REQUIRED)
# ============================================
# RPC URL - Use public RPC for testing, Alchemy/Infura for production
MEMEPERP_BLOCKCHAIN_RPC_URL=http://127.0.0.1:8545  # Anvil local testnet

# Chain ID
MEMEPERP_BLOCKCHAIN_CHAIN_ID=31337  # Anvil: 31337, Base Sepolia: 84532, Base Mainnet: 8453

# Settlement Contract Address (REQUIRED)
MEMEPERP_BLOCKCHAIN_POSITION_ADDRESS=  # REQUIRED: Deployed Settlement contract address

# Other Contract Addresses (Optional - depends on your deployment)
MEMEPERP_ROUTER_ADDRESS=
MEMEPERP_VAULT_ADDRESS=
MEMEPERP_AMM_ADDRESS=
MEMEPERP_LIQUIDATION_ADDRESS=
MEMEPERP_FUNDING_RATE_ADDRESS=
MEMEPERP_LENDING_POOL_ADDRESS=
MEMEPERP_PRICE_FEED_ADDRESS=

# Keeper/Matcher Private Key (REQUIRED for signing transactions)
# NEVER commit this value to git!
MEMEPERP_BLOCKCHAIN_PRIVATE_KEY=  # REQUIRED: 0x... format

# ============================================
# Security Configuration
# ============================================
# Allowed CORS origins (comma-separated)
MEMEPERP_SECURITY_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# Trusted proxy IPs (comma-separated, optional)
MEMEPERP_SECURITY_TRUSTED_PROXIES=

# ============================================
# Server Configuration
# ============================================
MEMEPERP_SERVER_ADDR=:8080
MEMEPERP_SERVER_MODE=debug  # Options: debug, release

# ============================================
# Rate Limiting
# ============================================
MEMEPERP_RATE_LIMIT_PUBLIC_LIMIT=1200   # requests per minute
MEMEPERP_RATE_LIMIT_PRIVATE_LIMIT=600   # requests per minute
MEMEPERP_RATE_LIMIT_ORDER_LIMIT=300     # requests per minute

# ============================================
# Logging
# ============================================
MEMEPERP_LOG_LEVEL=debug  # Options: debug, info, warn, error
MEMEPERP_LOG_FORMAT=json  # Options: json, console
MEMEPERP_LOG_OUTPUT=stdout  # Options: stdout, file path

# ============================================
# Settlement Contract (V2 Architecture)
# ============================================
# Settlement contract address (for V2 peer-to-peer trading)
MEMEPERP_SETTLEMENT_ADDRESS=

# ============================================
# Matching Engine Configuration
# ============================================
# Enable internal matching engine (set to true if running matching locally)
MEMEPERP_MATCHING_ENGINE_ENABLED=false

# External matching engine URL (if not running locally)
MEMEPERP_MATCHING_ENGINE_URL=http://localhost:8081

# Batch settlement interval (in seconds)
MEMEPERP_BATCH_INTERVAL=30

# ============================================
# Quick Start Guide
# ============================================
# 1. Copy this file: cp .env.template .env.local
# 2. Generate JWT secret: openssl rand -hex 32
# 3. Set database password
# 4. Deploy contracts:
#    cd contracts && forge script script/DeploySettlement.s.sol --rpc-url $RPC_URL --broadcast
# 5. Set SETTLEMENT_ADDRESS and MATCHER_PRIVATE_KEY
# 6. Run Go backend: APP_ENV=local go run cmd/api/main.go
# 7. Run Matching Engine: cd src/matching && npm run dev
